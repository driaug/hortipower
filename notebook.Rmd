---
title: "Hortipower Notebook"
output: html_notebook
---
**Group 3**

* Group members:
    - Dries Augustyns
    - Miguel Haest
    - Niels Baptist

We will report our findings of the kaggle dataset of **Hortipower**

If needed, we install the tidyverse package

```{r}
#install.packages("tidyverse")
```

Next, we import the tidyverse package
```{r}
library(tidyverse)
library(hms)
```

After this, we start loading all of our different data files.

## Loading climate data per sector 
```{r}
A1_klimaat <- read_delim('./data/binnen/vd_klimaat/1A_vd_klimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Rear')
V1_klimaat <- read_delim('./data/binnen/vd_klimaat/1V_vd_klimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Front')
A2_klimaat <- read_delim('./data/binnen/vd_klimaat/2A_vd_klimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Rear')
V2_klimaat <- read_delim('./data/binnen/vd_klimaat/2V_vd_klimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Front')
A5_klimaat <- read_delim('./data/binnen/vd_klimaat/5A_vd_klimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Rear')
V5_klimaat <- read_delim('./data/binnen/vd_klimaat/5V_vd_klimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Front')
A6_klimaat <- read_delim('./data/binnen/vd_klimaat/6A_vd_klimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Rear')
V6_klimaat <- read_delim('./data/binnen/vd_klimaat/6V_vd_klimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Front')
```

## Loading temparature data per sector
```{r}
A1_temperatuur <- read_delim('./data/binnen/temperatuur/1A_kastemperatuurklimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Rear')
V1_temperatuur <- read_delim('./data/binnen/temperatuur/1V_kastemperatuurklimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Front')
A2_temperatuur <- read_delim('./data/binnen/temperatuur/2A_kastemperatuurklimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Rear')
V2_temperatuur <- read_delim('./data/binnen/temperatuur/2V_kastemperatuurklimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Front')
A5_temperatuur <- read_delim('./data/binnen/temperatuur/5A_kastemperatuurklimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Rear')
V5_temperatuur <- read_delim('./data/binnen/temperatuur/5V_kastemperatuurklimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Front')
A6_temperatuur <- read_delim('./data/binnen/temperatuur/6A_kastemperatuurklimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Rear')
V6_temperatuur <- read_delim('./data/binnen/temperatuur/6V_kastemperatuurklimaat.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Front')
```

## Loading CO2 data per sector
```{r}
A1_co2 <- read_delim('./data/binnen/co2/1A_CO2.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Rear')
V1_co2 <- read_delim('./data/binnen/co2/1V_CO2.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Front')
A2_co2 <- read_delim('./data/binnen/co2/2A_CO2.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Rear')
V2_co2 <- read_delim('./data/binnen/co2/2V_CO2.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Front')
A5_co2 <- read_delim('./data/binnen/co2/5A_CO2.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Rear')
V5_co2 <- read_delim('./data/binnen/co2/5V_CO2.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Front')
A6_co2 <- read_delim('./data/binnen/co2/6A_CO2.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Rear')
V6_co2 <- read_delim('./data/binnen/co2/6V_CO2.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Front')
```

## Loading lighting per sector
```{r}
A1_assimilatiebelichting <- read_delim('./data/binnen/assimilatiebelichting/1A_assimilatiebelichting.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Rear')
V1_assimilatiebelichting <- read_delim('./data/binnen/assimilatiebelichting/1V_assimilatiebelichting.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Front')
A2_assimilatiebelichting <- read_delim('./data/binnen/assimilatiebelichting/2A_assimilatiebelichting.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Rear')
V2_assimilatiebelichting <- read_delim('./data/binnen/assimilatiebelichting/2V_assimilatiebelichting.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Front')
A5_assimilatiebelichting <- read_delim('./data/binnen/assimilatiebelichting/5A_assimilatiebelichting.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Rear')
V5_assimilatiebelichting <- read_delim('./data/binnen/assimilatiebelichting/5V_assimilatiebelichting.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Front')
A6_assimilatiebelichting <- read_delim('./data/binnen/assimilatiebelichting/6A_assimilatiebelichting.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Rear')
V6_assimilatiebelichting <- read_delim('./data/binnen/assimilatiebelichting/6V_assimilatiebelichting.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Front')
```

## Loading lee side window state per sector
```{r}
A1_luwezijderaamstand <- read_delim('./data/binnen/luwezijderaamstand/1A_luwezijderaamstand.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Rear')
V1_luwezijderaamstand <- read_delim('./data/binnen/luwezijderaamstand/1V_luwezijderaamstand.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '1', side = 'Front')
A2_luwezijderaamstand <- read_delim('./data/binnen/luwezijderaamstand/2A_luwezijderaamstand.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Rear')
V2_luwezijderaamstand <- read_delim('./data/binnen/luwezijderaamstand/2V_luwezijderaamstand.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '2', side = 'Front')
A5_luwezijderaamstand <- read_delim('./data/binnen/luwezijderaamstand/5A_luwezijderaamstand.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Rear')
V5_luwezijderaamstand <- read_delim('./data/binnen/luwezijderaamstand/5V_luwezijderaamstand.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '5', side = 'Front')
A6_luwezijderaamstand <- read_delim('./data/binnen/luwezijderaamstand/6A_luwezijderaamstand.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Rear')
V6_luwezijderaamstand <- read_delim('./data/binnen/luwezijderaamstand/6V_luwezijderaamstand.txt', delim=';', show_col_types = FALSE) %>% mutate(sector = '6', side = 'Front')
```

## Loading temperature outside
```{r}
buitentemperatuur <- select(read_delim('./data/buiten/temperatuur.txt', delim=';', show_col_types = FALSE), -group)
```

## loading solar radiation
```{r}
straling <- select(read_delim('./data/buiten/straling.txt', delim=';', show_col_types = FALSE), -group)
```

## loading the sum of solar radiation
```{r}
stralingssom <- select(read_delim('./data/buiten/stralingssom.txt', delim=';', show_col_types = FALSE), -group)
```

## Loading HPS tomato data
```{r}
HPS_sapstroom <- select(read_delim('./data/tomaat/HPS.txt', delim=';', locale=locale(decimal_mark=","), col_types = cols(DateTime = col_character(), Sapstroom = col_double(), Diameter = col_double(), type = col_character())), DateTime...1, Sapstroom)
HPS_diameter <- select(read_delim('./data/tomaat/HPS.txt', delim=';', locale=locale(decimal_mark=","), col_types = cols(DateTime = col_character(), Sapstroom = col_double(), Diameter = col_double(), type = col_character())), DateTime...3, Diameter)

HPS_sapstroom <- HPS_sapstroom %>% rename(DateTime = DateTime...1)
HPS_diameter <- HPS_diameter %>% rename(DateTime = DateTime...3)

HPS <- full_join(HPS_sapstroom, HPS_diameter, by = c('DateTime'))
HPS <- HPS %>% mutate(type = 'HPS')
HPS <- HPS %>% mutate(
    datetime = as.POSIXct(DateTime, format = "%d/%m/%Y %H:%M"), 
    date = as.Date(datetime, format = "%m/%d/%Y"), 
    time = as.hms(datetime, format = "%H:%M:%S"))
```

## Loading LED tomato data
```{r}
LED_sapstroom <- select(read_delim('./data/tomaat/LED.txt', delim=';', locale=locale(decimal_mark=","), col_types = cols(DateTime = col_character(), Sapstroom = col_double(), Diameter = col_double(), type = col_character())), DateTime...1, Sapstroom)
LED_diameter <- select(read_delim('./data/tomaat/LED.txt', delim=';', locale=locale(decimal_mark=","), col_types = cols(DateTime = col_character(), Sapstroom = col_double(), Diameter = col_double(), type = col_character())), DateTime...3, Diameter)

LED_sapstroom <- LED_sapstroom %>% rename(DateTime = DateTime...1)
LED_diameter <- LED_diameter %>% rename(DateTime = DateTime...3)

LED <- full_join(LED_sapstroom, LED_diameter, by = c('DateTime'))
LED <- LED %>% mutate(type = 'LED')
LED <- LED %>% mutate(
    datetime = as.POSIXct(DateTime, format = "%d/%m/%Y %H:%M"), 
    date = as.Date(datetime, format = "%m/%d/%Y"), 
    time = as.hms(datetime, format = "%H:%M:%S"))
```

## Joining the data into tibbles
```{r}
# Klimaat
klimaat <- select(bind_rows(A1_klimaat, V1_klimaat, A2_klimaat, V2_klimaat, A5_klimaat, V5_klimaat, A6_klimaat, V6_klimaat), -group)

# Temperatuur
temperatuur <- select(bind_rows(A1_temperatuur, V1_temperatuur, A2_temperatuur, V2_temperatuur, A5_temperatuur, V5_temperatuur, A6_temperatuur, V6_temperatuur), -group)

# CO2
co2 <- select(bind_rows(A1_co2, V1_co2, A2_co2, V2_co2, A5_co2, V5_co2, A6_co2, V6_co2), -group)

# Assimilatiebelichting
assimilatiebelichting <- select(bind_rows(A1_assimilatiebelichting, V1_assimilatiebelichting, A2_assimilatiebelichting, V2_assimilatiebelichting, A5_assimilatiebelichting, V5_assimilatiebelichting, A6_assimilatiebelichting, V6_assimilatiebelichting), -group)

# Luwezijderaamstand
luwezijderaamstand <- select(bind_rows(A1_luwezijderaamstand, V1_luwezijderaamstand, A2_luwezijderaamstand, V2_luwezijderaamstand, A5_luwezijderaamstand, V5_luwezijderaamstand, A6_luwezijderaamstand, V6_luwezijderaamstand), -group)

# Tomaat-sensors
tomaat <- bind_rows(LED, HPS)
tomaat <- tomaat %>% mutate(Sapstroom = round(Sapstroom, digits=1))
tomaat <- tomaat %>% mutate(type = as.factor(type))
tomaat
```

## Joining the inside & outside data
```{r}
binnen <- full_join(klimaat, temperatuur, by = c("date", "time", "sector", "side"))
binnen <- full_join(binnen, co2, by = c("date", "time", "sector", "side"))
binnen <- full_join(binnen, assimilatiebelichting, by = c("date", "time", "sector", "side"))
binnen <- full_join(binnen, luwezijderaamstand, by = c("date", "time", "sector", "side"))

buiten <- full_join(buitentemperatuur, straling, by = c("date", "time"))
buiten <- full_join(buiten, stralingssom, by = c("date", "time"))

data <- full_join(binnen, buiten, by = c("date", "time"))
data <- data %>% mutate(date = as.Date(date, format='%d-%m-%Y'))
```

## Cleaning it up
```{r}
binnen <- binnen %>% mutate(assimilatiebelichting = factor(assimilatiebelichting, levels = c(0, 100), labels=c("off", "on")))
```

## The data as one Tibble
```{r}
binnen
buiten
data
```

```{r}
data %>% filter(CO2 > 0) %>% ggplot(aes(x = side, y = CO2)) + geom_boxplot()
```

```{r}
data %>% filter(kastemperatuurklimaat > 0) %>% ggplot(aes(x = side, y = kastemperatuurklimaat)) + geom_boxplot()
```

```{r}
ggplot(tomaat, mapping = aes(x = time, y = Sapstroom, color=type)) + geom_point(size=0.1, alpha=0.1) + geom_smooth()
```

```{r}
ggplot(tomaat, mapping = aes(x = date, y = Diameter, color=type)) + geom_point(size=0.1, alpha=0.1) + geom_smooth()
```

```{r}
ggplot(tomaat, mapping = aes(x = date, y = Sapstroom)) + geom_point(size=0.1, alpha=0.1) + geom_smooth()
```

```{r}
data %>% filter(buitentemperatuur > -10) %>% ggplot(data, mapping = aes(x = date, y = buitentemperatuur)) + geom_point(size=0.1, alpha=0.1) + geom_smooth()
```

```{r}
data %>% filter(kastemperatuurklimaat > -10) %>% ggplot(data, mapping = aes(x = date, y = kastemperatuurklimaat, color=side)) + geom_point(size=0.1, alpha=0.1) + geom_smooth()
```